---
layout:     post
title:      "第二章：The governing systems of equations"
author:     "lili"
mathjax: true
sticky: false
excerpt_separator: <!--more-->
tags:
    - NWP
    - Weather Prediction
---

<!--more-->
**目录**
* TOC
{:toc}

## 2.1 The basic equations


本章描述了作为操作性和研究应用大气模型基础的控制方程系统。尽管大多数模型使用类似的方程集合，但确切的表述可以影响模型预报和模拟的准确性，甚至可能排除某些类型的大气波存在于模型解中。由于这些方程无法通过解析方法求解，因此必须将其转换为可求解的形式。通常用于实现这一目标的数值方法在第3章中描述。

大多数数值天气和气候预测模型的基础方程在所有第一年大气动力学课程中都有描述。对于球面地球的动量方程（方程2.1–2.3）代表了牛顿第二定律，即物体动量的变化率与作用于物体的合力成正比，并且与力的方向相同。热力学能量方程（方程2.4）考虑了各种对温度的影响，包括绝热和非绝热效应。总质量连续方程（方程2.5）说明质量既不增加也不减少，方程2.6类似，但仅适用于水蒸气。理想气体定律（方程2.7）将温度、压力和密度联系起来。变量具有其标准的气象含义。独立变量u、v和w是笛卡尔速度分量，p是压力，ρ是密度，T是温度，$q_v$是比湿(humidity)，Ω是地球的旋转频率，ϕ是纬度，a是地球的半径，γ是温度梯度(lapse rate of temperature)，$γ_d$是干绝热(dry adiabatic)温度梯度，$c_p$是恒定压力下空气的比热，g是重力加速度，H代表热量的增加或减少，$Q_v$是通过相变产生或消耗的水蒸气，Fr是每个坐标方向上的通用摩擦项。

<a>![](/img/nwcp/ch2/1.png)</a>

<a>![](/img/nwcp/ch2/2.png)</a>



完整的模型还将包含云水、云冰和不同类型降水的连续方程（见第4章）。有关这组预报(prognostic)、耦合、非线性、非齐次(nonhomogeneous)偏微分方程的讨论，请参阅Dutton（1976）和Holton（2004）。这些方程被称为原始方程，基于这些方程的模型被称为原始方程模型。这个术语用来区分这些模型与基于方程的不同版本（如涡度方程）的模型。几乎所有当代研究和操作模型都基于某个版本的这些原始方程。注意，与非绝热效应（H）、摩擦（Fr）以及相变中水的增益和损失（$Q_v$）有关的方程术语必须在模型中进行定义。这个特定的原始方程示例以压力为垂直坐标，但其他选项将在下一章中讨论。


## 2.2 雷诺(Reynolds)方程：分离未解决的湍流效应


上述方程适用于所有运动尺度，甚至对于太小而无法由设计用于天气过程的模型表示的波动和湍流也是如此。因为这种湍流在这些模型中无法明确解决，所以必须修改方程，使其仅适用于更大的非湍流运动。这可以通过将所有依赖变量分为平均和湍流部分，或者类似地分为空间分辨率和未解决的组件来实现。均值被定义为网格单元上的平均值，如Pielke（2002a）所述。例如：

<a>![](/img/nwcp/ch2/3.png)</a>


这些表达式被代入方程2.1至2.7中，产生了扩展，例如方程2.1右侧第一项的以下扩展：

<a>![](/img/nwcp/ch2/4.png)</a>

因为我们希望方程适用于平均运动，即非湍流的天气尺度，所以我们对所有项应用了一个平均算子。对于上述项，我们有

<a>![](/img/nwcp/ch2/5.png)</a>

请注意右侧最后一项是一个协方差项。其值取决于第一个量在乘积中是否与第二个量协变。例如，如果第一个部分的正值倾向于与第二个部分的负值配对，那么协方差和该项将为负值。如果乘积的两个部分在物理上没有相关性，则均值为零。然后，我们使用雷诺假设（雷诺1895年，伯恩斯坦1966年）简化方程。对于变量a和b，

<a>![](/img/nwcp/ch2/6.png)</a>


基于这些假设，方程2.9中的项变为

<a>![](/img/nwcp/ch2/7.png)</a>


在我们展示如何将这些方法应用于方程2.1至2.7中的所有项之前，让我们用典型的摩擦项$Fr_x$的表示重新写方程2.1，不包括地球曲率项，并且只有主导的科里奥利项。在这些明确表示湍流运动的方程中，子网格摩擦仅由粘性(viscous)力产生，这是分子运动的结果。

<a>![](/img/nwcp/ch2/8.png)</a>


这里，$τ_{zx}$是单位面积的力，或者是沿x方向由流体对恒定z平面一侧施加的动量或剪切应力，$τ_{xy}$和$τ_{xz}$是在另外两个坐标面上x方向的力。在假设的无粘性流体中，两侧流动之间没有“通信”。但在实际流体中，沿着每个坐标面的分子运动或分子扩散将允许属性的交换。压力的典型表示为

<a>![](/img/nwcp/ch2/9.png)</a>


这里，μ是动力粘度系数。这被称为牛顿摩擦，或者牛顿的应力定律。提到z平面两侧的两个（极浅的）流体层，如果流体中没有剪切，则粘度不会产生对另一层的应力或单位面积的力。将这些牛顿摩擦的表达式代入方程2.11中的$Fr_x$项，我们得到

<a>![](/img/nwcp/ch2/10.png)</a>

现在将平均过程应用于方程2.11中的所有项。特别地，我们将每个依赖变量表示为一个已解决的均值和一个未解决的湍流分量的总和，然后应用平均算子。使用雷诺假设，并假设ρ'远小于ρ，我们得到

<a>![](/img/nwcp/ch2/11.png)</a>

Stull（1988）使用尺度分析来展示，对于湍流运动的尺度，以下连续方程适用：

<a>![](/img/nwcp/ch2/12.png)</a>

将其乘以u'，进行平均，并加到方程2.13中，将湍流对流项转化为通量(flux)形式：

<a>![](/img/nwcp/ch2/13.png)</a>


类比于分子粘度相关的应力，我们定义湍流应力（也称为涡流应力或雷诺应力）如下：

<a>![](/img/nwcp/ch2/14.png)</a>

将这些表达式代入方程2.15中，并假设密度的空间导数远小于协方差的空间导数，我们得到

<a>![](/img/nwcp/ch2/15.png)</a>


这个方程与方程2.11相同，除了湍流应力项和均值符号。均值符号很少与原始方程一起使用，但人们仍然理解依赖变量仅代表非湍流运动。而且，湍流应力远大于粘性应力，因此通常不包括后者的项。湍流应力有时以“F”符号代表，指的是摩擦。用模型预测的变量表示湍流应力是边界层的湍流参数化的主题，或者是边界层上方的湍流参数化，详见第4章。

## 2.3 方程的近似方法

有几个原因可以解释为什么我们希望使用近似方程组作为模型的基础。

* 一些近似方程组在数值求解时比完整方程更有效率。例如，下面描述的静水压(hydrostatic)、布伦特-弗扬(Boussinesq)和不可压缩近似(anelastic approximations))并不允许解中存在声波，这意味着在产生一定长度的模拟或预测时需要的计算资源较少，具体原因将在下一章中解释。
* 完整方程描述了一个非常复杂的物理系统，使用它们在模型中进行研究以更好地理解大气中的因果关系具有挑战性。因此，有时会从方程组中移除特定的项和方程（以及相关的过程）。例如，移除所有相态水和相变的热力学影响方程，可以在更简单的设置中研究过程。
* 非常简单的方程形式更适合于教学应用和新数值算法的初步测试。例如，下面描述的浅层流体方程被用作NWP课程（以及本文）中“玩具模型”的基础。但是，它们包含了完整方程组的动力学的足够内容，因此可以用来测试新的差分方案，然后可以在完整模型中进行评估。

以下子节描述的近似方法在研究和运行模型中常被使用。

### 2.3.1 静水压(Hydrostatic)近似

模型解中存在相对快速传播的声波，这意味着需要短的时间步长才能保持模型的数值解稳定，具体将在下一章中解释。短时间步的结果是，在特定时间段的模型积分中需要更多的时间步长，并且需要更多的计算资源。因为声波通常对气象学没有重要性，所以希望使用一种不包含它们的方程形式。一种方法是采用静水压近似，其中完整的运动第三方程（方程2.3）被替换为仅包含重力和垂直压力梯度项的方程。即

<a>![](/img/nwcp/ch2/16.png)</a>
 

这意味着密度与垂直压力梯度相关联。由于声波的传播需要密度随波的纵向压缩和膨胀而调整，因此在静水压大气中不存在声波。为了使静水压假设成立，完整方程中消除的所有项的总和必须至少比保留项小一个数量级。换句话说

<a>![](/img/nwcp/ch2/17.png)</a>


对运动第三方程进行尺度分析（例如，Dutton 1976、Holton 2004）表明，静水压假设对于大尺度运动是有效的，但对于中尺度和对流尺度约小于10公里的长度尺度来说，效果会减弱。因此，分辨率较粗的全球模型往往基于静水压方程，而中尺度过程的模型则不会。在下一章中将展示其他处理模型网格上快速波的计算影响的方法。

### 2.3.2 Boussinesq和anelastic近似方法


与静力学假设类似，Boussinesq和anelastic近似方法是一系列近似方法的一部分，通过解耦压力和密度扰动，直接过滤方程中的声波。然而，它们的使用不仅限于建模较大的水平长度尺度，就像静力学近似方法一样。事实上，这些近似方法广泛用于中尺度或云尺度过程的模型中。 Boussinesq近似法（Boussinesq 1903）通过以下方式替代完整的连续性方程式2.5来获得：

<a>![](/img/nwcp/ch2/18.png)</a>


这相当于用体积守恒代替质量守恒。对于anelastic近似法（Ogura和Phillips 1962，Lipps和Hemler 1982），

<a>![](/img/nwcp/ch2/19.png)</a>

在这里，被用作完整的连续性方程的替代，其中 $\bar{ρ} = \bar{ρ} (z)$ 是一个稳态参考状态密度。此外，这两种近似法都涉及动量方程的简化（参见Durran 1999，第20-26页）。这类中的另一种近似法是由Durran (1989)描述的伪不可压缩近似。

### 2.3.3 浅层流体方程

浅层流体方程，有时称为浅水方程，可以作为简单模型的基础，用于说明和评估数值方案的特性。惯性-重力、对流(advective)和罗斯贝波可以被表示出来。这样的模型不仅有助于获得数值方法的经验，而且由于这些方程表示了完整气候模型中的大部分水平动力学，使其成为在简单框架中测试数值方法的有用工具。例如，Williamson等人（1992年）使用了一个应用于球体的浅层流体模型来测试用于气候模拟的数值方法。

“浅层流体”一词指的是模拟的波长必须相对于流体的深度来说很长。这套方程有各种形式（Nadiga等人，1996年），但在这里，流体被假定为自同温(autobarotropic)（由于定义而非由于当前大气条件），均匀的(homogeneous)、不可压缩的(incompressible)、静水的(hydrostatic)和无粘性的(inviscid)。均匀性条件意味着密度在空间中不变，而不可压缩性意味着在一块空气团内，密度随时间不变。我们从中推导出的方程如下：

<a>![](/img/nwcp/ch2/20.png)</a>

现在，不可压缩性和均匀性意味着

<a>![](/img/nwcp/ch2/21.png)</a>

<a>![](/img/nwcp/ch2/22.png)</a>

因此，静水力方程可以写成：

<a>![](/img/nwcp/ch2/23.png)</a>


对方程2.24关于x求导，并利用右侧是一个常数的事实，得到

<a>![](/img/nwcp/ch2/24.png)</a>


这意味着垂直压力梯度没有水平变化，水平压力梯度也没有垂直变化（即等压性的定义）。由于压力梯度力产生风，并产生相应的科里奥利力，所有力在高度上都是不变的。将方程2.24在流体深度上积分，

<a>![](/img/nwcp/ch2/25.png)</a>

将流体顶部和底部边界处的压力表示为 $P_T$ 和 $P_S$ ，对方程进行积分得到：

<a>![](/img/nwcp/ch2/26.png)</a>

如果 $P_T = 0$ ，或者 $P_T$ 远远小于 $P_S$ ，

<a>![](/img/nwcp/ch2/27.png)</a>


这个说法是指液体底部的水平压力梯度与液体深度梯度成正比，这为方程2.17和2.18中的压力梯度项提供了新的形式。无压缩连续性方程（方程2.23）也可以通过对z进行积分进行重写：

<a>![](/img/nwcp/ch2/28.png)</a>


如果u和v最初不是z的函数，它们将保持不变，因为压力梯度不是z的函数。并且，由于u和v不是z的函数，它们的导数也不是z的函数，因此

<a>![](/img/nwcp/ch2/29.png)</a>


对于z = h，水平下边界的动力学边界条件w = 0成立。认识到

<a>![](/img/nwcp/ch2/30.png)</a>


这导致了一个新的连续性方程。现在有三个变量u、v和h的三个方程。

<a>![](/img/nwcp/ch2/31.png)</a>


为了简化，经常使用这个方程组的一维版本。为了允许存在一个平均u分量，上面发生扰动，在y方向指定了一个所需大小的恒定压力梯度。一维方程为：

<a>![](/img/nwcp/ch2/32.png)</a>


和$\bar{U}$是指定的、恒定的平均地转风速度，u扰动在其上叠加。显然，这个方程组能够模拟真实大气的程度有限，但朝着更加真实的方向迈出的一步是定义与所代表的层次一致的流体深度，比如边界层或对流层。总大气的深度可以用尺度高度表示。

<a>![](/img/nwcp/ch2/33.png)</a>



其中$T_0$是地表温度，而H大约为8公里。如果模型大气代表对流层，可以假设深度为h的活动流体层上面是一个惰性层（如图2.1所示），代表平流层。这个惰性层对下层产生浮力，可以在模型中用减小的重力来表示。但这会影响地转风关系，因此更好的方法是按比例减小活动层的深度。这是有道理的，因为在外部重力波相速度的线性解中，加速度是通过流体的平均深度与重力加速度相乘得到的。任何一种方法的应用都会产生相同的效果，即将外部重力波的相速度减小到更符合层界面内部波的特性的速度。可以证明，应将重力或层深度减小一个因子$\alpha = (\theta_T – \theta_B ）/ \theta_B$ ，这个因子基于顶层和底层的平均位温。例如，对于下层代表对流层的情况，这个比值约为0.25，层的平均深度将定义为2公里。

<a>![](/img/nwcp/ch2/34.png)</a>
**图2.1 这是一个示意图，展示了一个浅层流体模型的垂直结构，在这个模型中，一个波脊位于计算域的中心。较低的阴影层代表活动流体，其深度（h）和风速分量进行了模拟。深度H是大气的尺度高度，α是将深度减小以考虑上面惰性层的浮力的因子。**


当以上非线性浅层流体方程被用作模型的基础时，每个方程都需要添加一个显式的数值扩散项，以抑制通过混叠过程增长的短波长，这将在下一章节中描述。关于浅层流体方程及其数值解的更多信息，请参考Kinnmark (1985), Pedlosky (1987), Durran (1999), 和McWilliams (2006)。
