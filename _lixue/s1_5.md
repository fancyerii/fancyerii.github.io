---
layout:     post
title:      "5. The Evolution of Societies"
author:     "lili"
mathjax: true
sticky: true
excerpt_separator: <!--more-->
tags:
    - Evolutionary Game Theory
    - 补充材料
    - Very Little Evolutionary Game Theory
---


本文是对[Very Little Evolutionary Game Theory](https://github.com/rmcelreath/VLEGT/)的翻译。
 
 <!--more-->
 
**目录**
* TOC
{:toc}
 
可能你并不是特别理解缅甸(Burmese)王朝的历史，但是你可能或多或少听说过一些。比如Minyedeippa(1608-1629)缅甸Taungoo王朝的第七个国王。他谋生了他的父亲，他父亲是国王Anaukpetlun，从而获得王位。但它只当了436天的国王，接着被他的叔叔，也就是第八任国王，处死了。王族的做法就是这样。【译注：原文是Royalty is as royalty does.】

动物王国也有类似的倾向。猫鼬(Meerkat)是一种瘦长的獴(mongoose)，它们生活在高度合作的大家庭中(extended family)。姐妹和堂姐妹们彼此合作寻找食物、养育后代和守卫领地。但是这种和谐关系是通过暴力建立起来的。当一个统治者死去的时候，对于王位的争夺非常激烈。背叛者会被驱逐甚至会被处死。

前一章我们关注家庭的原因是因为在这里合作更容易发生。但是家庭中不只有合作。这里也存在竞争。而且赌注越高，竞争的强度越大。家庭中怎么交互非常重要，而这又依赖于人口结构、自然资源、甚至有机体的生命长度。哈密尔顿规则($rb>c$)很简单，但是kin selection不简单。

在本章我们会探索两个例子，人口结构(population structure)在其中非常重要。第一个例子是问后代是否应该被从出生地驱逐出去。从结果来看自然选择鼓励驱逐，虽然这对后代来说非常危险，但这能避免兄弟之间的内斗。【译注：就像国王会把各王子分封出去，从而避免争夺王位。】第二个例子是问一个母亲应该生女儿还是生儿子，如果她能够选择的话。这些问题的答案依赖于家庭的互动方式。

在上面的两个例子中，策略空间都是连续的而不是离散的。前面的章节讨论的策略都是常规的离散策略，比如老鹰-鸽子或者TFT。但是这里被驱逐的后代数量以及儿子和女儿的比例，它们的取值范围都不是离散的。本章会介绍一种方法来处理连续策略空间。

## 驱逐和兄弟竞争

>如果存在本地资源的竞争，那么即使驱逐的成本(风险)很高也要好过兄弟直接的内斗，这样这些亲兄弟们可以和外面那些没有亲属关系的个体竞争。

假设有一个环境，这里只有n个领地(site)供一个成年个体繁殖后代。因为一个领地只能容纳一个成年个体，所以成年个体的总是不能超过n。每个成年个体产生k个后代然后死去。这些后代中被驱逐出当前领地的比例是v，它们会被随机的驱逐到其它n-1个领地。剩下的占比为1-v的后代会留着当前领地。驱逐是有风险的，那些被驱逐的后代只有p的比例能够幸运的到达新领地，其余的都在途中死去。一个领地的未成年个体，不管是被驱逐的移民还是留着老家的土著，它们都需要竞争这个领地，其中只有一个幸运儿能够存活下来并且长得成年和产生后代。

如果自然选择可以条件v，那么最优值应该是多少？为了回答这个问题，我们需要找到一个v，它是稳定的。这意味着和v接近的少量变异是不能长得更快并且替代掉大多数的v。【译注：稳定的意思就是少量的变异不能入侵，其实就是局部最优值，可能也是全局最优值。】所以我们假设只有一个领地的成年个体是变异，它的驱逐比例是$v+\delta$，而其它领地的驱逐比例是v。这里要求$\delta$比较小。

和往常一样，我们需要计算策略v的fitness。在这里非常简单，它是1。为什么呢？因为一个领地最多一个未成年后代存活，当然除非人口非常少，否则是不太可能有领地空下来的，所以一代的话就只有n个后代成功存活并且长大。所以平均的fitness是n/n=1。

那么变异的fitness呢？我们需要考虑不同的领地谁离开了和谁到来了。下图可以帮助我们分析：

<a>![](/img/lixue/s1/5.png)</a>
*Common类型(v)的领地*

上图是非变异(Common Type)策略(v)的领地，这也是图中(C)的含义。也就是说在上一代，这个领地的获胜者是策略v。它会产生k个后代，因此被驱逐的后代是vk，成功到达其它领地的数量是vpk。剩下的(1-v)k个后代留在这里。那么这个领地会有哪些移民呢？其它的n-1个领地可以分为两类：n-2个策略v驱逐过来的后代；1个策略$v+\delta$驱逐过来的后代。我们先来看策略v，也就是上图左上的那条入边。策略v会成功的驱逐vpk个后代，它们随机的散落到另外n-1个领地里，所以当前领地接受到的是$vpk/(n-1)$。上面我们分析了一个领地，这样的领地有n-2个，因此总的策略v带来的后代是$(n-2)\frac{vpk}{n-1}$。类似的，变异策略$v+\delta$也会驱逐出$(v+\delta)pk$个后代，它们也平均分散到n-1个领地，所以我们当前分析的领地接受到的个数是$\frac{(v+\delta)pk}{n-1}$

这个领地的所有后代都来竞争，因为没有其它信息，我们假设每个后代竞争获胜的概率一样，因此在n-1个非变异领地(C)里变异后代(M)竞争成功的概率为：

$$
Pr(M | C) = (n-1)\frac{\frac{(v+\delta)pk}{n-1}}{(1-v)k + \frac{(v+\delta)pk}{n-1} + \frac{(n-2)vpk}{n-1}}
$$

分子是一个C的领地里移民进来的M的后代数量，分母有三项：除了分子之外，还有当地土著和其它n-2个C领地的移民。此外还乘以了(n-1)，这是因为存在(n-1)个这样的C领地。这个式子可以化简，不过我们暂时不用管它。

不过上面的式子只是变异的fitness的一部分，我们还需要考虑那些留在父母领地里的变异者的fitness。我们仍然画图来帮助分析：

<a>![](/img/lixue/s1/6.png)</a>
*变异类型(M)的领地*

在这里，有$(1-v-\delta)k$个变异的后代留在了出生地。有$(v+\delta)pk$被驱散到其它领地。另外其它n-1个非变异领地的后代也会移民进来。每个领地的移民数量是vpk，有$1/(n-1)$的比例会来到这个领地。总共有(n-1)个非变异领地，因此总共有$(n-1)\frac{vpk}{n-1}$个非变异移民进入。在这个领地，变异的后代胜出的概率是：

$$
Pr(M|M)=\frac{(1-v-\delta)k}{(1-v-\delta)k+(n-1)\frac{vpk}{n-1}}
$$

现在我们要计算$Pr(M\|C)+Pr(M\|M)$，为了简化计算，我们假设领地的数量n很大，这样的话$(n-2)/(n-1) \approx 1$。这样我们得到：

$$
V_M \approx \frac{(v+\delta)p}{1-v+vp} + \frac{1-v-\delta}{1-v-\delta+vp}
$$

非变异策略的fitness是1。这除了沿用前面的假设，我们也可以用上面的式子假设$\delta=0$，这样的话这个变异者其实和非变异者一样，读者可以验证一下在$\delta=0$的情况下上式等于1。因此如果非变异策略稳定的话，要求上式小于1。我们可以假设$\delta$很小，这样$\delta^2=0$。通过复杂的计算，我们可以计算出：

$$
v^\star=\frac{2}{1-p}
$$

【译注：这种方法原文没有详细的推导过程，但是youtube的视频里有，感兴趣的读者可以看视频。】

除了这种方法(【译注：这种方法不需要微积分，但是其实用的也是微积分的思想，包括假设$\delta$很小，则$\delta^2=0$，这都是微积分高阶无穷小可以忽略的思想。】，我们下面介绍一种更简单的方法，但是这要求学过微积分，有导数这些概念。

把原来的非变异策略v用一个新的变量$v^\star$来表示，而变异用v来表示，我们得到：

$$
V_M \approx \frac{vp}{1-v^\star+v^\starp} + \frac{1-v}{1-v^\star+v*p}
$$

我们假设$v^\star$是常量，而变异v是变量。我们对v求导数计算$\frac{dV_M}{dv}$，并且计算这个导数在$v^\star$处的值，并且令这个值等于0，就可以解出最优的$v^\star$：

$$
\frac{dV_M}{dv}\bigg|_{v = v^\star} = 0
$$

解出来的结果也是$v^\star=\frac{2}{1-p}$。

【译注：我们的目标是求出最优的$v^\star$，它使得上面函数值最大。当然我们不知道。但是我们可以假设这个值是已知的，那么我们可以计算一个变异v的fitness。这样我们就得到一个函数，自变量是v，函数值是变异的fitness。我们对这个函数求导数，并且令它在$v^\star$处为零。这样的话$v^\star$是一个极大值点(更严格的还要看二阶导数)，也就是说它周围的v是无法入侵它的。这说起来可能有点绕，我们再来复述一下。我们要找到这样的$v^\star$，它比周围的函数值都大。怎么找到这样的$v^\star$呢？我们先假设$v^\star$是已知的常量，然后看变异v的fitness。我们写出这个函数$f(v;v^\star)$。如果这个函数在$v=v^\star$的时候不是最大值，比如$v=v^\star+0.02$的时候是最大值，那么$v=v^\star+0.02$就可以入侵$v^\star$。所以为了保证$v^\star$是不能被入侵的，我们要求$v=v^\star$的时候取最大值。根据最大值的条件，我们要求导数$df(v;v^\star)/dv$在最大值$v^\star$的时候导数值为0。】

我们回过头来看看$v^\star$。假设p=0，也就是说驱逐的后代都会死在路上，即使这样，$v^\star=1/2$意味着最优的策略是驱逐一半的后代。另外一个极端假设p=1，也就是路上完全安全，那么$v^\star=1$，也就是说把所有的后代都送到别人的领地去抢别人的土地。

为什么自然选择这么青睐驱逐呢？原因是竞争发生在局部的领地，而不是在全部人口中。如果兄弟们都留在老家，那么就得互相竞争。如果一部分被驱逐出去，那么它们就是和没有血缘关系的其它个体竞争了。所以比较讽刺的是，这样的模型里，亲属之间不是正向吸引的，而是互相排斥。如果修改每个领地能存活的后代数量m，使得m>1，则稳定的策略驱逐的可能性会下降。这是一个很好的练习题。

## 性别比例分配和局地竞争(sex allocation and local competition)

在进化博弈论里，我们通常忽略雄性。在一个混杂的动物群体里，很多雄性在完成受精后就不会再照顾后代(这在动物世界里很常见)，我们在模型忽略雄性是没有什么问题的。这样我们只需要关注雌性就可以了。但是也有例外，忽略雄性可能是不行的。比如这样性别配比的例子，也就是母亲决定(如果可以的话)自己的后代中雌性和雄性的比例。【译注：说母亲决定性别比例可能不准确，但是说基因决定性别比例是问题不大的。有的基因使得个体雌性生女儿多，另外一些基因使得生儿子多。其它因素相同的情况下自然选择会根据一定的逻辑选择某种基因。当然也有例外，有一些爬行动物的性别是由环境(比如温度)决定的，那么上面的假设就不一定成立了。但是即使这样，也许有些母亲会选择把蛋下在温度高的地方，有的母亲会在温度低的地方下蛋。这样的话自然选择还是可以发挥作用。】

最简单的模型假设的群体是正常混杂的，其雌性随机交配。这里没有空间的结构。【译注：实际肯定不是这样，一只东北的雄兔子不可能跑到华南去和另一只雌兔子交配。】初看起来，性别的差别似乎对于个体的fitness没有影响。如果一个雌性生育的后代是固定的b，那么不管雌雄这个目前的fitness都是一样的【除非在复杂的社会里有重男轻女或者重女轻男。】不过虽然性别不影响一个母亲的子女数量，但是可能会影响孙子孙女的数量【译注：似乎没有必要根据中国文化增加外孙和外孙女】。所以我们把孙辈的数量作为目前的fitness。【译注：作者在视频里提到，这里的模型比较简单，所以可以简单的考虑孙辈的数量。但是有些复杂的模型，孙辈多可能重孙辈少。理论上应该加权考虑所有后代，但是这样计算太过复杂。】

假设在群体中占据多数的个体策略是儿子的比例为r。因此每个母亲平均有rb个儿子以及(1-r)b个女儿。那么孙辈的数量为：

$$
V_r=\underbrace{(1-r)b^2}_{\text{daughter}} + \underbrace{rb^2\frac{n(1-r)b}{nrb}}_{\text{son}}
$$

上式的第一项是这个母亲的女儿产生的孙辈，她有(1-r)b个女儿，每个女儿会产生b个后代。第二项是她的儿子产生的孙辈。和女儿不同，儿子需要和它同辈的其它雄性展开竞争。第二项的那个分式是雌雄比，可以理解为一个雄性平均可以与多少个雌性交配。而这个母亲有rb个儿子，并且每一个儿媳妇(【好吧，没有更好的词了】)为她添b个孙子或孙女，所以是$rb^2$。

化简之后得到：

$$
V_r = b^2(1-r + r\frac{1-r}{r})=2b^2(1-r)
$$

这个式子看起来很有趣，因为它好像说孙辈的数量和女儿的数量成正比。因为女儿是$b(1-r)$。同样的逻辑，对于儿女比例为$(r+\delta)$的变异母亲，它的fitness是：

$$
V_{r'}=b^2(1-r'+r'\frac{1-r}{r})
$$

这里的雌雄比是基于非变异策略，因为群体中的多数是非变异策略，少量的变异者对于整体的雌雄比是没有太大影响的。

如果策略r是稳定的话，要求$V_r>v_{r'}$。我们用$r'=r+\delta$替代$r'$。这个条件化简后是：

$$
\delta(1-\frac{1-r}{r})>0
$$

假设雌雄比$\frac{1-r}{r}<1$，也就是儿子多。那么上式的括号的值大于0，所以要求$\delta>0$。所以如果变异生更多儿子($\delta>0$)，它是不能入侵的。但是如果变异生更多女儿的话，则是可以入侵的。这样自然选择驱使$\frac{1-r}{r}$接近1。类似的，如果雌雄比$\frac{1-r}{r}>1$，也就是女儿多，那么括号小于0，要求$\delta<0$。这样的话，变异者生儿子可以入侵，这样也驱使$\frac{1-r}{r}$接近1。因此平衡的状态是$\frac{1-r}{r}=1$，解出$r^*=0.5$。也就是男女一样多。从群体的角度来说，雌性更多则整体的孙辈更多【$(1-r)b^2$，r=0也就是全是女儿的话后代最多，但是似乎有点问题，那就是至少得有一个雄性吧。】不过自然状态下这种情况不会发生，男女的比例是1比1。【译注：很多非自然状态的群体，比如人类养殖的鸡鸭猪等，对于人类来说雄性是没用的，它们整天打斗，还不能下蛋。所以养殖的牲畜的雌雄比是是远远大于1的。】

如果我们引入空间结构，那么结果就会不同。有很多动物在出生时的性别比特别不平衡。比如无花果黄蜂(fig wasp)。无花果是一种水果，不同类别的无花果通过不同的黄蜂在其内部进行授粉。而无花果黄蜂也在无花果里繁殖后代。成年雌性在无花果里产卵，然后飞出无花果并死亡。黄蜂幼虫在无花果里孵化，成长并且交配。长大之后的雌性会飞出她的出生地，探索世界并找到新的无花果去繁殖后代。而雄性黄蜂会死在无花果里，它永远也不见天日。许多种类的无花果黄蜂的雌雄比都特别大，它们很少产生雄性后代。这是为什么呢？

【译注：以下内容来自网络[《“水果之王”无花果与黄蜂的恩怨情仇、合作共生的故事》](https://baike.baidu.com/tashuo/browse/content?id=cbfa87f1f7cae3e383e2e3e5)。

大家都知道，无花果可食用部分其实就是花，果实内部都是花蕊，因为花只能授粉后才能繁衍，但是因为无花果的花蕊被藏于果实内部，依靠风或是其他蜜蜂是难以完成传粉工作的，意味着它的传粉动物，即黄蜂，需要直接爬进无花果给花授粉。无花果和黄蜂彼此依赖对方完成繁殖。生物学上称之为互利共生。

这个生命循环是：年轻的无花果树长出不可食用的雄花，称为野生无花果，它会产生花粉。果树也长出雌花，雌花在囊状花托内成长并开放，风或蜜蜂无法像普通花一样给它授粉。

雌性黄蜂知道它们需要进入无花果产卵，所以它们会爬进雄性无花果和雌性无花果里试图产卵。雌性黄蜂通过一个狭窄的小孔钻入无花果内部。如果它进入的是雄性无花果，它就可以在一个理想环境中产卵，然后死去。它的卵会孵化，其中雄性首先孵化（此时它们又瞎又无力），它们会与雌性同伴交配。然后雄性黄蜂在雄性无花果中挖出通道，雌性黄蜂携带满满的受精卵和花粉飞走，开始新的循环。如果雌性黄蜂进入的是雌性无花果，它将无法产卵，最后饿死。然而它携带了花粉进去，完成了授粉。随后无花果迅速成熟，长成人们（以及动物们）爱吃的水果。
】

假设有n个雌蜂在一个无花果里，每个产b个蛋。假设$r$是常规策略，而$r'$是变异策略。我们需要写出变异策略的fitness的计算公式。我们分开讨论儿子和女儿的fitness会让问题变得简单。

首先，一个变异雌蜂平均会有$(1-r')b$个女儿。我们假设每个女儿都能受精(假设一个无花果里至少有一个雄性)，所以每个变异母亲通过女儿得到的孙辈数量是$(1-r')b^2$，这和前面的计算方法一样。

其次，每个变异母亲的儿子有$r'b$个。这些儿子们需要和同一个无花果里的其它雄蜂们(包括兄弟)竞争【译注：这里没有驱逐，所有的雄蜂一生都不会离开出生地。】。一个儿子能够和一个雌蜂交配的个数是这个无花果里的雌雄比。在这个无花果里的雌蜂为：

$$
f = (1-r')b+(n-1)(1-r)b
$$

这里的雄蜂数量为：

$$
m = r'b+(n-1)rb
$$

所以变异目前通过儿子获得的孙辈数量是$bf/m$。和前面不同的是，由于一个无花果里的雌蜂(n)不多，所以变异会影响这里的雌雄比。我们把从女儿和儿子获得的孙辈加起来，就得到了这个变异目前的fitness：

$$
V_{r'}=(1-r')b^2 + r'b^2\frac{f}{m} = (1-r')b^2 + r'b^2 \frac{(1-r')b+(n-1)(1-r)b}{r'b+(n-1)rb}
$$


和前面的方法类似，我们需要找到一个r，使得它周围的策略$r'=r+\delta$不能入侵。当$\delta$很小的时候，我们可以这样来近似：

$$
V_{r'} = V_r + \delta \frac{\partial V_{r'}}{\partial r'}\bigg|_{r' = r}
$$

这里是用一阶泰勒展开来近似$V_{r'}$。为了找到不能被入侵的策略r，我们要求第二项为零，也就是：

$$
\frac{\partial V_{r'}}{\partial r'}\bigg|_{r' = r}=0
$$

求解之后得到：

$$
r^*=\frac{n-1}{2n}
$$

如果n很大，$r^ \star$趋近于1/2。这和前面是相同的。但是如果n不是很多，比如n=2，则$r^\star=1/4$。这是倾向于更多女儿的。如果n趋向于1，则r趋向于零，也就是全部都生女儿。


