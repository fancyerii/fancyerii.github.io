---
layout:     post
title:      "第三章：Applications of Web Scraping"
author:     "lili"
mathjax: true
sticky: false
excerpt_separator: <!--more-->
tags:
    - python
    - scraping
---

<!--more-->
**目录**
* TOC
{:toc}

虽然网页抓取器几乎可以帮助任何企业，但通常真正的难题在于如何实现。像人工智能，或者说编程本身，你不能只是挥舞魔法棒就期望它改善你的利润。将网页抓取应用于你的业务需要真正的策略和仔细的规划，以便有效利用它。你需要识别特定的问题，弄清楚需要什么数据来解决这些问题，然后概述输入、输出和算法，这些算法将使你的网页抓取器生成这些数据。

## 项目分类

在规划网页抓取项目时，你应该考虑它如何适应几个类别之一。

你的网页抓取器是“广泛的”还是“有针对性的”？你可以编写模板来指导有针对性的网页抓取器，但广泛的抓取器需要不同的技术：

* 你会抓取单个网站还是甚至是该网站内的一组固定页面？如果是这样，这就是一个非常有针对性的网页抓取项目。
* 你需要抓取一组已知的网站吗？这仍然是一个相当有针对性的抓取器，但你可能需要为每个网站编写少量的自定义代码，并在网页抓取器的架构上投入更多时间。
* 你是否在抓取大量未知网站并动态发现新目标？你会构建一个必须自动检测和假设网站结构的爬虫吗？你可能正在编写一个广泛或无目标的抓取器。

你需要一次性运行抓取器还是这将是一个持续的工作，不断重新获取数据或不断寻找要抓取的新页面？

* 一次性网页抓取项目可以快速且便宜地编写。代码不必精美！该项目的最终结果是数据本身——你可能会交出一个Excel或CSV文件给业务部门，他们很满意。完成后代码可以丢弃。

* 任何涉及监控、重新扫描新数据或更新数据的项目，都需要更健壮的代码，能够维护。它可能还需要自己的监控基础设施，以检测何时遇到错误、无法运行或使用的时间或资源超出预期。

收集的数据是你的最终产品还是需要更深入的分析或操作？

* 在简单的数据收集中，网页抓取器将数据直接存入数据库，或许进行一些简单的清理（例如，去除产品价格中的美元符号）。
* 当需要更高级的分析时，你甚至可能不知道哪些数据是重要的。在这种情况下，你也必须更加考虑抓取器的架构。

我鼓励你考虑每个项目可能属于哪一类，以及该项目的范围如何需要修改以适应你的业务需求。



 
## 电子商务

虽然我编写过各种从网页上收集有趣数据的网页抓取器，但我收到的最常见请求是从电子商务网站上收集产品和价格数据。

通常，这些请求来自拥有竞争性电子商务网站的人，或者是正在进行研究、计划推出新产品或进入新市场的人。在电子商务中，你可能首先想到的指标是“价格”。你想了解你的价格与竞争对手的价格相比如何。然而，还有很多其他可能的数据你可能想收集。

许多产品（但不是全部）都有各种尺寸、颜色和样式的变化。这些变化可能与不同的成本和可用性相关。记录每种产品的每个变化，以及每个主要产品列表，可能会有所帮助。请注意，对于每个变化，你可能会找到唯一的SKU（库存单位）识别码，该代码对于单个产品变化和电子商务网站是唯一的（Target 和 Walmart 对于每个产品变化有不同的SKU，但如果你以后回头查看，SKU会保持不变）。即使SKU在网站上并不立即可见，你很可能会在页面的HTML代码中或在填充网站产品数据的JavaScript API中找到它。

在抓取电子商务网站时，记录产品的可用数量也可能很重要。像SKU一样，单位数量可能在网站上并不立即可见。你可能会在HTML或网站使用的API中找到此信息。确保还记录产品缺货的情况！这对于评估市场需求以及影响你自己产品的定价（如果你有库存）可能很有用。

当产品打折时，你通常会在网站上清楚地看到折扣价和原价。确保分别记录这两个价格。通过跟踪一段时间内的销售情况，你可以分析竞争对手的促销和折扣策略。

产品评价和评分是另一个有用的信息来源。当然，你不能直接在自己的网站上显示来自竞争对手网站的产品评价文本。然而，分析这些评价的原始数据可以帮助你了解哪些产品受欢迎或正流行。


## 营销

在线品牌管理和营销通常涉及大量数据的聚合。与其在社交媒体上滚动浏览或花费数小时搜索公司的名字，不如让网页抓取器做所有繁重的工作！

恶意攻击者可以利用网页抓取器来“复制”网站，目的是销售假冒商品或欺骗潜在客户。幸运的是，网页抓取器也可以帮助打击这种行为，通过扫描搜索引擎结果，查找公司商标和其他知识产权的欺诈或不当使用。有些公司，如MarqVision，还将这些网页抓取器作为服务出售，让品牌可以外包抓取网页、检测欺诈和发布删除通知的过程。

另一方面，并非所有使用品牌商标的行为都是侵权。如果你的公司被提及用于评论或评估，你可能会想知道这些信息！网页抓取器可以聚合和跟踪公众对公司及其品牌的情感和看法。

在全网跟踪你的品牌时，不要忘记你的竞争对手！你可以考虑抓取那些评价过竞争产品或讨论过竞争品牌的人的信息，以便向他们提供折扣或试用促销。

当然，谈到营销和互联网，首先想到的往往是“社交媒体”。抓取社交媒体的好处在于，通常只有少数大型网站允许你编写有针对性的抓取器。这些网站包含数百万格式良好的帖子，具有类似的数据和属性（如点赞、分享和评论），可以轻松地在网站间进行比较。

社交媒体的缺点是获取数据可能会遇到障碍。一些网站，如Twitter，提供免费的或收费的API。其他社交媒体网站则通过技术和法律手段保护其数据。我建议你在抓取Facebook和LinkedIn等网站之前，咨询公司法律顾问。

跟踪关于与你品牌相关话题的帖子的指标（点赞、分享和评论）有助于识别热门话题或互动机会。根据内容长度、包含图像/媒体和语言使用等属性跟踪受欢迎程度，还可以识别哪些内容最能引起目标受众的共鸣。

如果让拥有数亿粉丝的人赞助你的产品超出了公司的预算，你可以考虑“微影响者”或“纳米影响者”——社交媒体存在感较小的用户，他们甚至可能不认为自己是影响者！在这里，构建一个网页抓取器以找到和定位那些经常发布与你品牌相关话题的账户将会很有帮助。

## 学术研究

虽然本章的大多数例子最终都是为了促进资本主义的发展，网页抓取器也被用于追求知识。网页抓取器常用于医学、社会学和心理学研究等多个领域。

例如，罗格斯大学开设了一门名为“计算社会科学”的课程，教授学生使用网页抓取来收集研究项目的数据。一些大学课程，如奥斯陆大学的“收集和分析大数据”，甚至将本书列入课程大纲！

2017年，由美国国家卫生研究院支持的一个项目抓取了美国监狱囚犯的记录，以估算感染艾滋病毒的囚犯数量。该项目引发了一场广泛的伦理分析，权衡了这项研究的好处与囚犯隐私风险之间的关系。最终，研究继续进行，但我建议在使用网页抓取进行研究之前，特别是在医学领域，仔细审查项目的伦理问题。

另一项健康研究从《卫报》关于肥胖的新闻文章中抓取了数百条评论，并分析了这些评论的修辞。尽管规模小于其他研究项目，但值得考虑的是，网页抓取器也可以用于需要“小数据”和定性分析的项目。

以下是另一个利用网页抓取进行小众研究的例子。2016年，一项全面研究抓取并对每个加拿大社区学院的营销材料进行了定性分析。研究人员发现，现代设施和“非常规组织符号”是最受推崇的。

在经济学研究中，日本银行发布了一篇关于他们使用网页抓取获取“替代数据”的论文。所谓替代数据，是指银行通常使用的GDP统计数据和公司财务报告之外的数据。在这篇论文中，他们透露了网页抓取器是替代数据的一个来源，他们利用这些数据来调整价格指数。

## 产品构建

你是否有一个商业想法，并且只需要一个包含相对公共、常识性信息的数据库来启动？是否找不到价格合理且方便的现成信息来源？你可能需要一个网页抓取器。

网页抓取器可以快速提供数据，让你获得一个最低可行产品（MVP）进行发布。以下是一些网页抓取器可能是最佳解决方案的情况：

**旅游网站，列出热门旅游景点和活动**

在这种情况下，仅仅一个简单的地理信息数据库是不够的。你需要知道人们将会参观的是基督救世主，而不仅仅是里约热内卢，巴西。一个企业目录也不太合适。虽然人们可能对大英博物馆非常感兴趣，但街边的赛恩斯伯里超市并没有同样的吸引力。然而，许多旅游评论网站已经包含了关于热门旅游景点的信息。

**产品评论博客**

抓取一份产品名称和关键词或描述的列表，然后使用你喜欢的生成型聊天AI来补充其余内容。

说到人工智能，那些模型需要数据——通常是大量的数据！无论你是希望预测趋势还是生成逼真的自然语言，网页抓取通常是获取产品训练数据集的最佳方式。

许多商业服务产品需要拥有严格保密的行业知识，这些知识可能昂贵或难以获得，例如工业材料供应商列表、特定领域专家的联系信息或各公司开放的职位。网页抓取器可以汇集在网上各处找到的这些信息，使你能够以相对较低的前期成本建立一个综合数据库。

## 旅行

无论你是想创办一家旅游相关的公司，还是非常热衷于在下次度假时省钱，旅游行业因其提供的多种网页抓取应用而值得特别关注。

酒店、航空公司和租车服务在各自的市场中几乎没有产品差异化，竞争对手众多。这意味着价格通常非常接近，并且会随着市场条件的变化而频繁波动。

尽管像Kayak和Trivago这样的网站现在可能已经足够大和强大，可以支付或获得API，但所有公司都是从某个地方开始的。网页抓取器可以成为启动新的旅游聚合网站的一个绝佳方式，通过从网络各处找到最优惠的交易来吸引用户。

即使你不打算创业，是否曾乘坐飞机或计划将来乘坐？如果你在寻找测试本书技能的想法，我强烈推荐写一个旅游网站抓取器作为第一个项目。大量的数据和这些数据随时间的波动提供了一些有趣的工程挑战。

旅游网站在反抓取防御方面也处于中间地带。它们希望被搜索引擎爬取和索引，并希望使其数据对用户友好且易于访问。然而，它们与其他旅游网站的竞争激烈，这可能需要使用本书后面介绍的一些高级技术。关注浏览器头信息和Cookies是一个好的起点。

如果你发现自己被某个旅游网站屏蔽，不确定如何通过Python访问其内容，请放心，可能还有其他旅游网站拥有相同的数据供你尝试。

## 销售

网页抓取器是获取销售线索的理想工具。如果你知道某个网站上有你的目标市场的联系信息来源，剩下的工作就简单了。无论你的领域多么小众都不重要。在我与销售客户的合作中，我抓取过青少年体育队教练、健身房老板、护肤品供应商等各种目标受众的名单，用于销售目的。

招聘行业（我认为是销售的一个子集）经常在双方利用网页抓取器。候选人资料和职位列表都会被抓取。由于LinkedIn的强力反抓取政策，插件如Instant Data Scraper或Dux-Soup常常被用来在浏览器中手动访问时抓取候选人资料。这使得招聘人员能够在抓取页面之前快速浏览候选人，确保他们适合职位描述。

像Yelp这样的目录可以帮助定制实体企业的搜索，比如“昂贵程度”、是否接受信用卡、提供外送或餐饮服务，或是否提供酒类。虽然Yelp主要以餐馆评论闻名，但它也有关于本地木匠、零售店、会计师、汽车修理店等详细信息。

像Yelp这样的网站不仅仅是向客户宣传企业——联系信息也可以用来进行销售介绍。同样，详细的过滤工具可以帮助你定制目标市场。

抓取员工目录或招聘网站也可以成为获取员工姓名和联系信息的宝贵来源，这有助于进行更有针对性的销售介绍。检查Google的结构化数据标签（见下一节，“SERP抓取”）是构建广泛网页抓取器的好策略，可以在抓取可靠、格式良好的联系信息的同时，定位多个网站。

本书中的几乎所有例子都是关于抓取网站的“内容”——它们呈现的人类可读信息。然而，即使是网站的底层代码也能透露很多信息。它使用什么内容管理系统？有没有关于其服务器端技术栈的线索？是否有任何客户聊天机器人或分析系统？

了解潜在客户可能已经使用或需要的技术，对于销售和营销来说是非常有价值的。


## SERP抓取

SERP(search engine results page)，即搜索引擎结果页面抓取，是直接从搜索引擎结果中抓取有用数据，而无需访问链接页面的做法。搜索引擎结果的好处是其格式已知且一致，而搜索引擎链接的页面格式多样且未知，处理这些页面既繁琐又麻烦，能避免最好。

搜索引擎公司有专门的人员，他们的全部工作就是利用元数据分析、巧妙编程和AI工具从网站中提取页面摘要、统计数据和关键词。使用他们的结果，而不是尝试在内部复制这些结果，可以节省大量时间和金钱。

例如，如果你想获取过去40年所有主要美国体育联盟的排名信息，你可能会找到各种信息来源。http://nhl.com有一种格式的冰球排名，而http://nfl.com有另一种格式的橄榄球排名。然而，搜索“nba standings 2008”或“mlb standings 2004”会提供一致格式的结果，并可以深入查看该赛季的个别比赛得分和球员信息。

你可能还需要关于搜索结果本身的存在和排名信息，例如，跟踪哪些网站出现以及它们在某些搜索词中的顺序。这可以帮助监控你的品牌，并留意竞争对手。

如果你正在运行搜索引擎广告活动，或有意启动一个，你可以仅监控广告而不是所有搜索结果。同样，你可以跟踪哪些广告出现、它们的顺序，或许还可以了解这些结果随时间的变化。

确保不要只限于主要的搜索结果页面。例如，Google有Google Maps、Google Images、Google Shopping、Google Flights、Google News等。这些本质上都是不同类型内容的搜索引擎，可能与你的项目相关。

即使你没有从搜索引擎本身抓取数据，了解搜索引擎如何找到和标记它们在特殊搜索结果功能和增强显示的数据也可能有帮助。搜索引擎不会进行大量的猜测来确定如何显示数据；它们要求网页开发人员专门格式化内容，以便由像它们这样的第三方显示。

Google的结构化数据文档可以在此处找到。如果你在抓取网页时遇到这些数据，现在你就知道如何使用它们了。













